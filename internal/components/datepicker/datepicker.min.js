(()=>{(function(){function E(e){if(!e||typeof e!="string")return null;let t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return null;let a=parseInt(t[1],10),n=parseInt(t[2],10)-1,i=parseInt(t[3],10),r=new Date(Date.UTC(a,n,i));return r.getUTCFullYear()===a&&r.getUTCMonth()===n&&r.getUTCDate()===i?r:null}function u(e,t,a){if(!e||isNaN(e.getTime()))return"";let n={timeZone:"UTC"};switch(t){case"locale-short":n.dateStyle="short";break;case"locale-long":n.dateStyle="long";break;case"locale-full":n.dateStyle="full";break;case"locale-medium":default:n.dateStyle="medium";break}try{return new Intl.DateTimeFormat(a,n).format(e)}catch(i){console.error(`Error formatting date with Intl (locale: ${a}, format: ${t}, timezone: UTC):`,i);try{let r={dateStyle:"medium",timeZone:"UTC"};return new Intl.DateTimeFormat(a,r).format(e)}catch(r){console.error(`Error formatting date with fallback Intl (locale: ${a}, timezone: UTC):`,r);let s=e.getUTCFullYear(),d=(e.getUTCMonth()+1).toString().padStart(2,"0"),c=e.getUTCDate().toString().padStart(2,"0");return`${s}-${d}-${c}`}}}function f(e){if(!e||e._datePickerInitialized)return;let t=e.id,a=e.querySelector("[data-datepicker-display]"),n=t+"-calendar-instance",i=document.getElementById(n),r=n+"-hidden",s=document.getElementById(r),d=i,c=s;if(!i||!s){let l=e.getAttribute("aria-controls"),o=l?document.getElementById(l):null;if(o&&(d||(d=o.querySelector("[data-calendar-container]")),!c)){let m=o.querySelector("[data-calendar-wrapper]");c=m?m.querySelector("[data-calendar-hidden-input]"):null}}if(!a||!d||!c){console.error("DatePicker init error: Missing required elements.",{datePickerID:t,displaySpan:a,calendar:d,hiddenInput:c});return}let h=e.dataset.displayFormat||"locale-medium",k=e.dataset.localeTag||"en-US",C=e.dataset.placeholder||"Select a date",I=l=>{if(!l.detail||!l.detail.date||!(l.detail.date instanceof Date))return;let o=l.detail.date,m=u(o,h,k);a.textContent=m,a.classList.remove("text-muted-foreground");let S=e.closest("[data-popover]")?.querySelector("[data-popover-trigger]");S instanceof HTMLElement?S.click():e.click()},D=()=>{if(c&&c.value){let l=E(c.value);if(l){let o=u(l,h,k);a.textContent.trim()!==o&&(a.textContent=o,a.classList.remove("text-muted-foreground"))}else a.textContent=C,a.classList.add("text-muted-foreground")}else a.textContent=C,a.classList.add("text-muted-foreground")};d.addEventListener("calendar-date-selected",I),D(),e._datePickerInitialized=!0,e._datePickerCleanup=()=>{d&&d.removeEventListener("calendar-date-selected",I)}}function p(e=document){e instanceof Element&&e.matches('[data-datepicker="true"]')&&f(e),e.querySelectorAll('[data-datepicker="true"]').forEach(t=>{f(t)})}let y=e=>{let t=e.detail.elt;t instanceof Element&&requestAnimationFrame(()=>p(t))};document.addEventListener("DOMContentLoaded",()=>p()),document.body.addEventListener("htmx:beforeSwap",e=>{let t=e.detail.elt;if(t instanceof Element){let a=n=>{n.matches&&n.matches('[data-datepicker="true"]')&&n._datePickerCleanup&&(n._datePickerCleanup(),delete n._datePickerCleanup,delete n._datePickerInitialized)};t.matches&&t.matches('[data-datepicker="true"]')&&a(t),t.querySelectorAll&&t.querySelectorAll('[data-datepicker="true"]').forEach(a)}}),document.body.addEventListener("htmx:afterSwap",y),document.body.addEventListener("htmx:oobAfterSwap",y)})();})();
