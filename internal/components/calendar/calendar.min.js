(()=>{(function(){function T(e){if(!e||e._calendarInitialized)return;let l=e.querySelector("[data-calendar-month-display]"),h=e.querySelector("[data-calendar-weekdays]"),m=e.querySelector("[data-calendar-days]"),v=e.querySelector("[data-calendar-prev]"),x=e.querySelector("[data-calendar-next]"),E=e.closest("[data-calendar-wrapper]"),p=E?E.querySelector("[data-calendar-hidden-input]"):null;if(!l||!h||!m||!v||!x||!p){console.error("Calendar init error: Missing required elements (or hidden input relative to wrapper).",e);return}let g=e.dataset.localeTag||"en-US",D;try{D=Array.from({length:12},(a,t)=>new Intl.DateTimeFormat(g,{month:"long",timeZone:"UTC"}).format(new Date(Date.UTC(2e3,t,1))))}catch(a){console.error(`Calendar: Error generating month names via Intl (locale: "${g}"). Falling back to English.`,a),D=["January","February","March","April","May","June","July","August","September","October","November","December"]}let M=["Su","Mo","Tu","We","Th","Fr","Sa"];try{M=Array.from({length:7},(a,t)=>new Intl.DateTimeFormat(g,{weekday:"short"}).format(new Date(Date.UTC(2e3,0,t))))}catch(a){console.error("Error generating calendar day names via Intl:",a)}let r=parseInt(e.dataset.initialMonth),s=parseInt(e.dataset.initialYear),f=null;e.dataset.selectedDate&&(f=I(e.dataset.selectedDate));function I(a){if(!a)return null;try{let t=a.split("-"),o=parseInt(t[0],10),i=parseInt(t[1],10)-1,u=parseInt(t[2],10),c=new Date(Date.UTC(o,i,u));if(!isNaN(c)&&c.getUTCFullYear()===o&&c.getUTCMonth()===i&&c.getUTCDate()===u)return c}catch{}return null}function C(){let a=Math.max(0,Math.min(11,r)),o=`${D[a]} ${s}`;l.textContent=o}function U(){h.innerHTML="",M.forEach(a=>{let t=document.createElement("div");t.className="text-center text-xs text-muted-foreground font-medium",t.textContent=a,h.appendChild(t)})}function y(){m.innerHTML="";let o=new Date(Date.UTC(s,r,1)).getUTCDay(),i=new Date(Date.UTC(s,r+1,0)).getUTCDate(),u=new Date,c=new Date(Date.UTC(u.getFullYear(),u.getMonth(),u.getDate()));for(let d=0;d<o;d++){let n=document.createElement("div");n.className="h-8 w-8",m.appendChild(n)}for(let d=1;d<=i;d++){let n=document.createElement("button");n.type="button",n.className="inline-flex h-8 w-8 items-center justify-center rounded-md text-sm font-medium focus:outline-none focus:ring-1 focus:ring-ring",n.textContent=d,n.dataset.day=d;let S=new Date(Date.UTC(s,r,d)),q=f&&S.getTime()===f.getTime(),F=S.getTime()===c.getTime();q?n.classList.add("bg-primary","text-primary-foreground","hover:bg-primary/90"):F?n.classList.add("bg-accent","text-accent-foreground"):n.classList.add("hover:bg-accent","hover:text-accent-foreground"),n.addEventListener("click",N),m.appendChild(n)}}function k(){r--,r<0&&(r=11,s--),C(),y()}function L(){r++,r>11&&(r=0,s++),C(),y()}function N(a){let t=parseInt(a.target.dataset.day);if(!t)return;let o=new Date(Date.UTC(s,r,t));f=o;let i=o.toISOString().split("T")[0];p.value=i,p.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new CustomEvent("calendar-date-selected",{bubbles:!0,detail:{date:o}})),y()}v.addEventListener("click",k),x.addEventListener("click",L),C(),U(),y(),e._calendarInitialized=!0}function w(e=document){e instanceof Element&&e.matches("[data-calendar-container]")&&T(e);for(let l of e.querySelectorAll("[data-calendar-container]"))T(l)}let b=e=>{let l=e.detail.elt;l instanceof Element&&requestAnimationFrame(()=>w(l))};document.addEventListener("DOMContentLoaded",()=>w()),document.body.addEventListener("htmx:afterSwap",b),document.body.addEventListener("htmx:oobAfterSwap",b)})();})();
